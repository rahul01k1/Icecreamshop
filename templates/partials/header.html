{% load static %}

<header class="header">
    <section class="flex">

        <!-- LOGO -->
        <a href="{% url 'home' %}" class="logo">
            <img src="{% static 'image/logo.png' %}" alt="logo" width="130">
        </a>

        <!-- NAVIGATION -->
        <nav class="navbar">
            <a href="{% url 'home' %}">Home</a>
            <a href="{% url 'menu' %}">Shop</a>
            <a href="{% url 'order' %}">Orders</a>
            <a href="{% url 'about' %}">About Us</a>
            <a href="{% url 'contact' %}">Contact</a>
        </nav>

        <!-- SEARCH BAR -->
        <form action="{% url 'search_product' %}" method="POST" class="search-form">
            {% csrf_token %}
            <input type="text" name="search_product" placeholder="Search products..." required maxlength="100">
            <button type="submit">
                <img src="{% static 'image/icon/search.png' %}" alt="Search">
            </button>
        </form>

        <!-- ICONS SECTION -->
        <div class="icons">

            <!-- Mobile Menu -->
            <div id="menu-btn">
                <img src="{% static 'image/icon/list.png' %}" alt="menu">
            </div>

            <!-- Mobile Search -->
            <div id="search-btn">
                <img src="{% static 'image/icon/search.png' %}" alt="search">
            </div>

            <!-- Wishlist -->
            <a href="{% url 'wishlist' %}" class="icon-btn">
                <img src="{% static 'image/icon/wl.png' %}" alt="wishlist">
                <span id="wishlist-count">0</span>
            </a>

            <!-- Cart -->
            <a href="{% url 'cart' %}" class="icon-btn">
                <img src="{% static 'image/icon/cart.png' %}" alt="cart">
                <span id="cart-count">0</span>
            </a>

            <!-- USER AVATAR -->
            <div class="user-icon">
                {% if request.session.user_id %}
                    <img src="/media/{{ request.session.user_image }}"
                         id="user-btn"
                         class="user-avatar">
                {% else %}
                    <img src="{% static 'image/icon/profile.png' %}"
                         id="user-btn"
                         class="user-avatar">
                {% endif %}
            </div>

        </div>

        <!-- PROFILE DROPDOWN -->
        <div class="profile-detail">

            {% if request.session.user_id %}

                <img src="/media/{{ request.session.user_image }}"
                     alt="Profile"
                     class="profile-photo">

                <h3 class="username">{{ request.session.user_name }}</h3>

                <div class="flex-btn">
                    <a href="{% url 'profile' %}" class="btn">View Profile</a>
                    <a href="{% url 'logout' %}" 
                       onclick="return confirm('Logout from this website?');" 
                       class="btn">
                       Logout
                    </a>
                </div>

            {% else %}

                <h3 class="username">Please login or register</h3>

                <div class="flex-btn">
                    <a href="{% url 'login' %}" class="btn">Login</a>
                    <a href="{% url 'register' %}" class="btn">Register</a>
                </div>

            {% endif %}

        </div>

    </section>
</header>

<style>
/* Cleaner UI styling for dropdown and avatar */
.user-avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    object-fit: cover;
    cursor: pointer;
}

.profile-photo {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    margin-bottom: .5rem;
    object-fit: cover;
}

.profile-detail {
    position: absolute;
    top: 90px;
    right: 20px;
    width: 250px;
    padding: 1.5rem;
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 8px 25px rgba(0,0,0,.15);
    display: none;
    text-align: center;
    z-index: 1000;
}

.username {
    margin-bottom: 1rem;
}

.icon-btn {
    position: relative;
}

.icon-btn span {
    position: absolute;
    top: -6px;
    right: -10px;
    background: #E85C96;
    color: #fff;
    font-size: 12px;
    padding: 2px 6px;
    border-radius: 50%;
}
</style>

