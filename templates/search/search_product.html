{% extends "base.html" %}
{% load static %}
{% block title %}Search Product - Blue Sky Summer{% endblock %}

{% block content %}


<div class="search-wrapper">

    <h1 class="search-title">Search Results</h1>
    <img src="{% static 'image/separator-img.png' %}" class="search-separator" width="180">

    <div class="product-grid">

        {% if products %}
            {% for product in products %}
            <form action="{% url 'add_to_cart' product.id %}" method="post" class="product-card">
                {% csrf_token %}

                <!-- STOCK BADGE -->
                {% if product.product_stock > 9 %}
                    <span class="stock-badge stock-green">In Stock</span>
                {% elif product.product_stock == 0 %}
                    <span class="stock-badge stock-red">Out of Stock</span>
                {% else %}
                    <span class="stock-badge stock-red">Only {{ product.product_stock }} left!</span>
                {% endif %}

                <!-- IMAGE -->
                <img src="{{ product.product_image.url }}" class="main-img" alt="">

                <!-- DETAILS -->
                <div class="card-body">

                    <div class="product-name">{{ product.product_name }}</div>

                    <div class="product-price">â‚¹{{ product.product_price }}</div>

                    <!-- ACTION ICONS -->
                    <div class="card-actions">
                        <div class="action-icons">
                            <button type="submit"><i class="bx bx-cart"></i></button>
                            <button type="submit" formaction="{% url 'add_to_wishlist' product.id %}">
                                <i class="bx bx-heart"></i>
                            </button>
                            <a href="{% url 'view_product' product.id %}" class="bx bxs-show"></a>
                        </div>
                    </div>

                    <input type="hidden" name="product_id" value="{{ product.id }}">

                    <!-- BUY NOW + QTY -->
                    <div class="buy-section">
                        <a href="{% url 'checkout' %}?get_id={{ product.id }}" class="buy-btn">Buy Now</a>

                        <input type="number" name="qty" min="1" max="99" value="1" class="qty-input">
                    </div>

                </div>

            </form>
            {% endfor %}
        {% else %}
            <div class="empty">
                <p>No products found!</p>
            </div>
        {% endif %}
        
    </div>

</div>


{% endblock %}
