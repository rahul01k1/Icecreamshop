<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{% endblock title %}</title>

    <!-- Main CSS -->
    <link rel="stylesheet" href="{% static 'css/user_style.css' %}">

    <!-- Boxicons -->
    <link rel="stylesheet" href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css">

    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body>

    {% include "partials/header.html" %}

    {% block content %}{% endblock content %}

    {% include "partials/footer.html" %}
    {% block footer %}{% endblock footer %}

    <!-- SweetAlert v1 (only if you still use swal()) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>

    <!-- Main JS -->
    <script src="{% static 'js/user_script.js' %}"></script>

    <!-- Global Count Updaters -->
    <script>


        function updateCartCount() {
            fetch("/cart-count/")
                .then(response => response.json())
                .then(data => {
                    const cartCount = document.getElementById("cart-count");
                    if (cartCount) cartCount.textContent = data.count;
                });
        }

        function updateWishlistCount() {
            fetch("/wishlist-count/")
                .then(response => response.json())
                .then(data => {
                    const wishCount = document.getElementById("wishlist-count");
                    if (wishCount) wishCount.textContent = data.count;
                });
        }

        // Auto-run counts on page load
        document.addEventListener("DOMContentLoaded", function () {
            updateCartCount();
            updateWishlistCount();
        });

        function confirmCancel(orderId) {
            Swal.fire({
                title: "Cancel Order?",
                text: "This action cannot be undone.",
                icon: "warning",
                showCancelButton: true,
                confirmButtonColor: "#ff7fa8",
                cancelButtonColor: "#999",
                confirmButtonText: "Yes, Cancel Order"
            }).then((result) => {
                if (result.isConfirmed) {
                    window.location.href = `/cancel_order/${orderId}/`;
                }
            });
        }

    </script>

</body>
</html>
